Процедура ПримерИспользованияКамеры() Экспорт
    
    // Создание COM объекта с новым именем
    КамераOLE = Новый COMОбъект("AsterWebCamTo1C.WebCameraCapture");
    
    // Инициализация с выбором камеры
    Если НЕ КамераOLE.InitializeWithCamera(0) Тогда
        Сообщение("Ошибка инициализации: " + КамераOLE.GetErrorMessage());
        Возврат;
    КонецЕсли;
    
    // Получение количества камер
    КоличествоКамер = КамераOLE.GetCameraCount();
    Сообщение("Найдено камер: " + КоличествоКамер);
    
    // Получение списка камер
    СписокКамер = КамераOLE.GetDeviceList();
    Для Индекс = 0 По СписокКамер.UBound() Цикл
        Сообщение("Камера " + Индекс + ": " + СписокКамер[Индекс]);
    КонецЦикла;
    
    // Захват кадра
    ДвоичныеДанные = КамераOLE.CaptureFrame();
    
    // Проверка результата
    Если ДвоичныеДанные.Размер() = 0 Тогда
        Сообщение("Ошибка захвата: " + КамераOLE.GetErrorMessage());
        Возврат;
    КонецЕсли;
    
    // Сохранение в файл
    ПутьФайла = "C:\Temp\photo.jpg";
    ФайлВывода = Новый ЗаписьДвоичныхДанных(ПутьФайла);
    ФайлВывода.Записать(ДвоичныеДанные);
    ФайлВывода.Закрыть();
    
    Сообщение("Фото сохранено в " + ПутьФайла);
    
    // Очистка
    КамераOLE.Cleanup();
    
КонецПроцедуры

Процедура ЦиклЗахватаКадров() Экспорт
    
    КамераOLE = Новый COMОбъект("AsterWebCamTo1C.WebCameraCapture");
    КамераOLE.InitializeWithCamera(0);
    
    // Захватываем 10 кадров
    Для Итератор = 1 По 10 Цикл
        
        ДвоичныеДанные = КамераOLE.CaptureFrame();
        
        Если ДвоичныеДанные.Размер() > 0 Тогда
            ПутьФайла = "C:\Temp\photo_" + Итератор + ".jpg";
            ФайлВывода = Новый ЗаписьДвоичныхДанных(ПутьФайла);
            ФайлВывода.Записать(ДвоичныеДанные);
            ФайлВывода.Закрыть();
            Сообщение("Сохранен кадр " + Итератор);
        КонецЕсли;
        
        // Задержка 1 секунда
        ТекущаяОс = Новый ОперационнаяСистема();
        ТекущаяОс.СпящийПроцесс(1000);
        
    КонецЦикла;
    
    КамераOLE.Cleanup();
    
КонецПроцедуры

Процедура ПримерЗахватаСИзменениемРазмера() Экспорт
    
    КамераOLE = Новый COMОбъект("AsterWebCamTo1C.WebCameraCapture");
    
    // Инициализация второй камеры (если есть)
    Если КамераOLE.GetCameraCount() > 1 Тогда
        КамераOLE.InitializeWithCamera(1);
    Иначе
        КамераOLE.InitializeWithCamera(0);
    КонецЕсли;
    
    // Захват кадра с изменением размера до 640x480
    ДвоичныеДанные = КамераOLE.CaptureFrameWithSize(640, 480);
    
    Если ДвоичныеДанные.Размер() > 0 Тогда
        ПутьФайла = "C:\Temp\photo_resized.jpg";
        ФайлВывода = Новый ЗаписьДвоичныхДанных(ПутьФайла);
        ФайлВывода.Записать(ДвоичныеДанные);
        ФайлВывода.Закрыть();
        Сообщение("Фото с измененным размером сохранено");
    Иначе
        Сообщение("Ошибка: " + КамераOLE.GetErrorMessage());
    КонецЕсли;
    
    КамераOLE.Cleanup();
    
КонецПроцедуры
